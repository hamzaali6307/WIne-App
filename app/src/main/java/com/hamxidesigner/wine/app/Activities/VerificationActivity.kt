package com.hamxidesigner.wine.app.Activitiesimport `in`.aabhasjindal.otptextview.OTPListenerimport `in`.aabhasjindal.otptextview.OtpTextViewimport android.content.Intentimport android.os.Bundleimport android.util.Logimport android.view.Gravityimport android.view.animation.AnimationUtilsimport android.widget.*import androidx.appcompat.app.AppCompatActivityimport com.google.android.gms.tasks.Taskimport com.google.android.material.snackbar.Snackbarimport com.google.firebase.auth.*import com.hamxidesigner.wine.app.Helper.SessionManagerimport com.hamxidesigner.wine.app.Rclass VerificationActivity : AppCompatActivity() {    lateinit var img_verify: ImageView    lateinit var authId: String    lateinit var mAuth: FirebaseAuth    lateinit var linear :LinearLayout    lateinit var snackbar:Snackbar    lateinit var sessionManager:SessionManager    lateinit var varCode: String    lateinit var phoneNo: String    lateinit var txt_phone: TextView    lateinit var otpTextView: EditText    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        setContentView(R.layout.activity_verification)        initViews()        initObjec()        clickViews()    }    private fun clickViews() {        img_verify.setOnClickListener {            val aniFade = AnimationUtils.loadAnimation(applicationContext, R.anim.model_in)            img_verify.startAnimation(aniFade)            if(varCode.equals(otpTextView)){                verifyCode(authId,varCode)                Toast.makeText(applicationContext, "The OTP matched", Toast.LENGTH_SHORT).show()            }else{                Toast.makeText(applicationContext, "The OTP does not matched try again", Toast.LENGTH_SHORT).show()            }        }    }    private fun verifyCode(authId: String, varCode: String) {        try {            val credential = PhoneAuthProvider.getCredential(authId, varCode)            signInWithPhoneAuthCredential(credential)        } catch (e: Exception) {            val toast = Toast.makeText(this, "Verification Code is wrong", Toast.LENGTH_SHORT)            toast.setGravity(Gravity.CENTER, 0, 0)            toast.show()        }    }    private fun signInWithPhoneAuthCredential(credential: PhoneAuthCredential) {        mAuth.signInWithCredential(credential)                .addOnCompleteListener(this) { task: Task<AuthResult?> ->                    if (task.isSuccessful) {                        val user = task.result!!.user                        sessionManager.setId("true")                        var intent  =  Intent(this, MainActivity::class.java)                            startActivity(intent)                    } else {                        Log.w("login", "signInWithCredential:failure", task.exception)                        snackbar = Snackbar                                .make(linear, "Some thing went wrong", Snackbar.LENGTH_LONG)                        snackbar.show()                        if (task.exception is FirebaseAuthInvalidCredentialsException) {                        }                    }                }    }    private fun initObjec() {        sessionManager = SessionManager(applicationContext)        var intent = intent        authId = intent.getStringExtra("authId")        varCode = intent.getStringExtra("varCode")        phoneNo = intent.getStringExtra("phoneNo")        txt_phone.setText(phoneNo)    }    private fun initViews() {        img_verify = findViewById(R.id.img_verify)        txt_phone = findViewById(R.id.txt_phone)        otpTextView = findViewById(R.id.txt_otp)        linear = findViewById(R.id.linear)    }}